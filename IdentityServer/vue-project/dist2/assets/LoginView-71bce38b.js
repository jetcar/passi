import{_ as d,c as l,a as e,b as h,t as u,d as a,w as g,v as _,n as p,o as i}from"./index-1d82e7d8.js";const m="/identity/img/en_badge_web_generic.png",C="/api/login",k="/api/check",y={data(){return{LoginInput:{Username:"",ReturnUrl:this.$route.query.returnUrl,Nonce:this.$route.query.nonce},LoginResponse:{checkColor:"red"},errorMessage:!1,loginForm:!0,loading:!1}},methods:{async handleCancelClick(){this.loginForm=!0,this.loading=!1},async handleCheckCancelClick(){this.loginForm=!0,this.loading=!1},async fetchCheck(){const c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.LoginResponse)};fetch(k,c).then(s=>{s.ok?s.json().then(n=>{n.redirect?window.location.replace(n.redirect):setTimeout(()=>this.fetchCheck(),1e3)}):resp.json().then(n=>{this.errorMessage=n.errors})}).catch(s=>this.errorMessage=s)},async handleLoginClick(){this.errorMessage=!1,this.loading=!0,this.LoginInput.ReturnUrl=this.$route.query.ReturnUrl;const c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.LoginInput)};var s=await fetch(C,c);s.ok?s.json().then(n=>{this.LoginResponse=n,this.loginForm=!1,this.loading=!1,this.fetchCheck()}):(this.errorMessage=(await s.json()).errors.Username[0],this.loginForm=!0,this.loading=!1)}}},f={class:"container"},v=e("div",{class:"lead"},[e("h1",null,"Login")],-1),b={key:0,class:"error-page"},L=e("div",{class:"lead"},[e("h1",null,"Error")],-1),w={class:"row"},U={class:"col-sm-6"},M={class:"alert alert-danger"},R={key:1,class:"row"},x={class:"col-md-6"},T={class:"card"},F={class:"card-body"},I={key:0,class:"spinner-border",role:"status"},O=e("span",{class:"sr-only"},null,-1),N=[O],P=e("br",null,null,-1),S={key:1,class:"form-group"},j=e("label",{for:"username"},"Username",-1),q={key:2,class:"row"},B={class:"col-md-6"},V=e("label",{for:"CheckColor"},null,-1),E=e("a",{href:"https://play.google.com/store/apps/details?id=com.passi.cloud.passi_android&pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1"},[e("img",{style:{"max-width":"200px"},alt:"Get it on Google Play",src:m})],-1),A=e("br",null,null,-1);function D(c,s,n,G,o,r){return i(),l("main",null,[e("div",f,[e("div",null,[e("div",null,[v,o.errorMessage?(i(),l("div",b,[L,e("div",w,[e("div",U,[e("div",M,[h(" Sorry, there was an error "),e("div",null,u(o.errorMessage),1)])])])])):a("",!0),o.loginForm?(i(),l("div",R,[e("div",x,[e("div",T,[e("div",F,[o.loading?(i(),l("div",I,N)):a("",!0),P,o.loading?a("",!0):(i(),l("div",S,[j,g(e("input",{class:"form-control",placeholder:"Username","onUpdate:modelValue":s[0]||(s[0]=t=>o.LoginInput.username=t),name:"username",id:"username",autofocus:""},null,512),[[_,o.LoginInput.username]])])),o.loading?a("",!0):(i(),l("button",{key:2,class:"btn btn-primary",name:"button",onClick:s[1]||(s[1]=(...t)=>r.handleLoginClick&&r.handleLoginClick(...t)),value:"login"},"Login")),e("button",{class:"btn btn-secondary",name:"button",onClick:s[2]||(s[2]=(...t)=>r.handleCancelClick&&r.handleCancelClick(...t)),value:"cancel"},"Cancel")])])])])):a("",!0),o.loginForm?a("",!0):(i(),l("div",q,[e("div",B,[V,e("div",{class:p(["coloredBox",o.LoginResponse.checkColor])},"Â ",2),e("button",{class:"btn btn-secondary",name:"button",value:"cancel","asp-action":"CancelLogin",onClick:s[3]||(s[3]=(...t)=>r.handleCheckCancelClick&&r.handleCheckCancelClick(...t))},"Cancel")])]))]),E,A])])])}const K=d(y,[["render",D]]);export{K as default};
